<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Назви за 10 секунд</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0e1a25;
    color: #fff;
}

/* ===== HEADER ===== */
.header {
    display: flex;
    justify-content: space-between;
    padding: 20px;
    font-size: 28px;
}
.team {
    padding: 10px 20px;
    border-radius: 14px;
    opacity: 0.4;
}
.team.active {
    opacity: 1;
    background: #1f8ef1;
}
.score {
    font-size: 22px;
}

/* ===== GRID ===== */
.grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 15px;
    padding: 20px;
}
.card {
    background: #203239;
    border-radius: 16px;
    height: 110px;
    font-size: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}
.card.used {
    visibility: hidden;
}

/* ===== OVERLAY ===== */
.overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.88);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.overlay.show {
    display: flex;
}

.question {
    font-size: 48px;
    text-align: center;
    max-width: 80%;
    margin-bottom: 30px;
    line-height: 1.3;
    opacity: 0;
    transform: scale(0.96);
}
.question.animate {
    animation: questionFade 0.6s ease forwards;
}
@keyframes questionFade {
    to { opacity: 1; transform: scale(1); }
}

.question b {
    color: #f2bd7c;
    animation: pop 0.4s ease;
}
.question mark {
    background: #ea9076;
    color: #203239;
    padding: 4px 10px;
    border-radius: 8px;
    animation: pop 0.4s ease;
}
@keyframes pop {
    from { transform: scale(0.85); }
    to { transform: scale(1); }
}

.timer {
    font-size: 120px;
    margin: 20px 0;
}
.timer.warning {
    color: #ea9076;
    animation: blink 0.6s infinite;
}
@keyframes blink {
    0%,100% { opacity: 1; }
    50% { opacity: 0.4; }
}

/* ===== BUTTONS ===== */
.buttons button {
    font-size: 32px;
    padding: 20px 40px;
    margin: 20px;
    border-radius: 16px;
    border: none;
    cursor: pointer;
}
.success { background: #2ecc71; }
.fail { background: #e74c3c; }
</style>
</head>

<body>

<div class="header">
    <div class="team active" id="team1">Команда 1<br><span class="score" id="score1">0</span></div>
    <div class="team" id="team2">Команда 2<br><span class="score" id="score2">0</span></div>
</div>

<div class="grid" id="grid"></div>

<div class="overlay" id="overlay">
    <div class="question" id="question"></div>
    <div class="timer" id="timer">10</div>
    <div class="buttons">
        <button class="success" onclick="finish(true)">Зарахувати</button>
        <button class="fail" onclick="finish(false)">Не зарахувати</button>
    </div>
</div>

<script>
let TIME_LIMIT = 10;
let currentTeam = 0;
let scores = [0,0];
let cards = [];
let currentCard = null;
let timerInterval = null;
let timeLeft = 0;

const grid = document.getElementById('grid');
const overlay = document.getElementById('overlay');
const timerEl = document.getElementById('timer');
const questionEl = document.getElementById('question');

/* ===== LOAD DATA ===== */
fetch('cards.json')
  .then(r => r.json())
  .then(data => initGame(data));

function initGame(data) {
    TIME_LIMIT = data.settings.default_time;

    data.themes.forEach(theme => {
        theme.cards.forEach(card => {
            cards.push({...card, used:false});
        });
    });

    cards.forEach((card, i) => {
        const el = document.createElement('div');
        el.className = 'card';
        el.innerText = card.difficulty;
        el.onclick = () => openCard(i, el);
        grid.appendChild(el);
        card.el = el;
    });
}

/* ===== GAME LOGIC ===== */
function openCard(index, el) {
    if (cards[index].used) return;

    currentCard = cards[index];
    el.classList.add('used');
    currentCard.used = true;

    overlay.classList.add('show');

    questionEl.innerHTML = currentCard.question;
    questionEl.classList.remove('animate');
    void questionEl.offsetWidth;
    questionEl.classList.add('animate');

    timeLeft = TIME_LIMIT;
    timerEl.innerText = timeLeft;
    timerEl.classList.remove('warning');

    if (currentCard.audio) {
        const audio = new Audio(currentCard.audio);
        audio.play();
        audio.onended = () => setTimeout(startTimer, 500);
    } else {
        setTimeout(startTimer, 3000);
    }
}

function startTimer() {
    timerInterval = setInterval(() => {
        timeLeft--;
        timerEl.innerText = timeLeft;
        if (timeLeft <= 3) timerEl.classList.add('warning');
        if (timeLeft <= 0) clearInterval(timerInterval);
    }, 1000);
}

function finish(success) {
    clearInterval(timerInterval);
    overlay.classList.remove('show');

    if (success) {
        scores[currentTeam] += currentCard.difficulty;
        document.getElementById(`score${currentTeam+1}`).innerText = scores[currentTeam];
    }
    switchTeam();
}

function switchTeam() {
    document.getElementById('team1').classList.remove('active');
    document.getElementById('team2').classList.remove('active');
    currentTeam = currentTeam === 0 ? 1 : 0;
    document.getElementById(`team${currentTeam+1}`).classList.add('active');
}
</script>

</body>
</html>
